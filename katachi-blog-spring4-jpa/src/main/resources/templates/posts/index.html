<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">
<head>
	<script th:src="@{/js/admin-post.js}" defer></script>
</head>
<body>
	<main layout:fragment="content" id="post-index">
		<h5 class="text-center" th:text="#{post.index}">
			記事一覧
		</h5>

		<div class="mypost-list my-4 container">
			<p th:if="${#lists.size(posts) == 0}" class="text-center" th:text="#{post.nothing}">
				Nothing Posted
			</p>
			<div th:if="${#lists.size(posts) > 0}" class="card px-3">
				<table class="table table-hover mt-3">
					<tbody>
						<tr th:each="post: ${posts}">
							<td>
								<a th:href="@{/posts/{slug}(slug=${post.slug})}"
									class="link-dark link-underline-opacity-0"
									th:text="${post.title}"
								>
									記事タイトル
								</a>
							</td>
							<td th:text="${#temporals.format(post.postedAt, #locale)}">
								投稿日時
							</td>
							<td class="row row-cols-auto justify-content-end">
								<div class="col">
									<a th:href="@{/admin/posts/{id}/edit(id=${post.id})}"
										class="btn btn-sm btn-success"
										th:text="#{post.edit.btn}"
									>
										Edit
									</a>
								</div>
								<div class="col">
									<button type="button"
										class="btn btn-sm btn-danger"
										data-bs-toggle="modal"
										data-bs-target="#deleteModal"
										th:attr="data-bs-id=${post.id}, data-bs-message=#{post.delete.confirm(${post.title})}"
										th:text="#{post.delete.btn}"
									>
										Delete
									</button>
								</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>

			<div th:if="${page.totalPages} > 1">
				<nav th:replace="~{components/pagination::pagination}"></nav>
			</div>

			<div class="modal fade" id="deleteModal" tabindex="-1"
				aria-labelledby="deleteModalLabel" aria-hidden="true"
			>
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h1 class="modal-title fs-5"
								id="deleteModalLabel"
								th:text="#{post.delete.title}"
							>
								削除
							</h1>
							<button type="button" class="btn-close"
								data-bs-dismiss="modal" aria-label="Close"
							></button>
						</div>
						<div class="modal-body">
							<p>確認メッセージ</p>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary"
								data-bs-dismiss="modal"
								th:text="#{cancel}"
							>
								Cancel
							</button>
							<form th:method="post" th:action="@{/admin/posts/delete}">
								<input type="hidden" name="id">
								<button class="btn btn-primary" th:text="#{post.delete.btn}">
									Delete
								</button>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>
</body>

</html>